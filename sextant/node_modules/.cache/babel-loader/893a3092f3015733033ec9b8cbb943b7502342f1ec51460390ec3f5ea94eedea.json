{"ast":null,"code":"/************************************************************************\n *  Copyright 2010-2015 Brian McKelvey.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n ***********************************************************************/\n\nvar extend = require('./utils').extend;\nvar util = require('util');\nvar EventEmitter = require('events').EventEmitter;\nvar WebSocketRouterRequest = require('./WebSocketRouterRequest');\nfunction WebSocketRouter(config) {\n  // Superclass Constructor\n  EventEmitter.call(this);\n  this.config = {\n    // The WebSocketServer instance to attach to.\n    server: null\n  };\n  if (config) {\n    extend(this.config, config);\n  }\n  this.handlers = [];\n  this._requestHandler = this.handleRequest.bind(this);\n  if (this.config.server) {\n    this.attachServer(this.config.server);\n  }\n}\nutil.inherits(WebSocketRouter, EventEmitter);\nWebSocketRouter.prototype.attachServer = function (server) {\n  if (server) {\n    this.server = server;\n    this.server.on('request', this._requestHandler);\n  } else {\n    throw new Error('You must specify a WebSocketServer instance to attach to.');\n  }\n};\nWebSocketRouter.prototype.detachServer = function () {\n  if (this.server) {\n    this.server.removeListener('request', this._requestHandler);\n    this.server = null;\n  } else {\n    throw new Error('Cannot detach from server: not attached.');\n  }\n};\nWebSocketRouter.prototype.mount = function (path, protocol, callback) {\n  if (!path) {\n    throw new Error('You must specify a path for this handler.');\n  }\n  if (!protocol) {\n    protocol = '____no_protocol____';\n  }\n  if (!callback) {\n    throw new Error('You must specify a callback for this handler.');\n  }\n  path = this.pathToRegExp(path);\n  if (!(path instanceof RegExp)) {\n    throw new Error('Path must be specified as either a string or a RegExp.');\n  }\n  var pathString = path.toString();\n\n  // normalize protocol to lower-case\n  protocol = protocol.toLocaleLowerCase();\n  if (this.findHandlerIndex(pathString, protocol) !== -1) {\n    throw new Error('You may only mount one handler per path/protocol combination.');\n  }\n  this.handlers.push({\n    'path': path,\n    'pathString': pathString,\n    'protocol': protocol,\n    'callback': callback\n  });\n};\nWebSocketRouter.prototype.unmount = function (path, protocol) {\n  var index = this.findHandlerIndex(this.pathToRegExp(path).toString(), protocol);\n  if (index !== -1) {\n    this.handlers.splice(index, 1);\n  } else {\n    throw new Error('Unable to find a route matching the specified path and protocol.');\n  }\n};\nWebSocketRouter.prototype.findHandlerIndex = function (pathString, protocol) {\n  protocol = protocol.toLocaleLowerCase();\n  for (var i = 0, len = this.handlers.length; i < len; i++) {\n    var handler = this.handlers[i];\n    if (handler.pathString === pathString && handler.protocol === protocol) {\n      return i;\n    }\n  }\n  return -1;\n};\nWebSocketRouter.prototype.pathToRegExp = function (path) {\n  if (typeof path === 'string') {\n    if (path === '*') {\n      path = /^.*$/;\n    } else {\n      path = path.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n      path = new RegExp('^' + path + '$');\n    }\n  }\n  return path;\n};\nWebSocketRouter.prototype.handleRequest = function (request) {\n  var requestedProtocols = request.requestedProtocols;\n  if (requestedProtocols.length === 0) {\n    requestedProtocols = ['____no_protocol____'];\n  }\n\n  // Find a handler with the first requested protocol first\n  for (var i = 0; i < requestedProtocols.length; i++) {\n    var requestedProtocol = requestedProtocols[i].toLocaleLowerCase();\n\n    // find the first handler that can process this request\n    for (var j = 0, len = this.handlers.length; j < len; j++) {\n      var handler = this.handlers[j];\n      if (handler.path.test(request.resourceURL.pathname)) {\n        if (requestedProtocol === handler.protocol || handler.protocol === '*') {\n          var routerRequest = new WebSocketRouterRequest(request, requestedProtocol);\n          handler.callback(routerRequest);\n          return;\n        }\n      }\n    }\n  }\n\n  // If we get here we were unable to find a suitable handler.\n  request.reject(404, 'No handler is available for the given request.');\n};\nmodule.exports = WebSocketRouter;","map":{"version":3,"names":["extend","require","util","EventEmitter","WebSocketRouterRequest","WebSocketRouter","config","call","server","handlers","_requestHandler","handleRequest","bind","attachServer","inherits","prototype","on","Error","detachServer","removeListener","mount","path","protocol","callback","pathToRegExp","RegExp","pathString","toString","toLocaleLowerCase","findHandlerIndex","push","unmount","index","splice","i","len","length","handler","replace","request","requestedProtocols","requestedProtocol","j","test","resourceURL","pathname","routerRequest","reject","module","exports"],"sources":["C:/Users/AMRITESH/OneDrive - Babu Banarasi Das National Institute of Technology and Management/Documents/Workspace/ReactJs/sextant/node_modules/websocket/lib/WebSocketRouter.js"],"sourcesContent":["/************************************************************************\n *  Copyright 2010-2015 Brian McKelvey.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n ***********************************************************************/\n\nvar extend = require('./utils').extend;\nvar util = require('util');\nvar EventEmitter = require('events').EventEmitter;\nvar WebSocketRouterRequest = require('./WebSocketRouterRequest');\n\nfunction WebSocketRouter(config) {\n    // Superclass Constructor\n    EventEmitter.call(this);\n\n    this.config = {\n        // The WebSocketServer instance to attach to.\n        server: null\n    };\n    if (config) {\n        extend(this.config, config);\n    }\n    this.handlers = [];\n\n    this._requestHandler = this.handleRequest.bind(this);\n    if (this.config.server) {\n        this.attachServer(this.config.server);\n    }\n}\n\nutil.inherits(WebSocketRouter, EventEmitter);\n\nWebSocketRouter.prototype.attachServer = function(server) {\n    if (server) {\n        this.server = server;\n        this.server.on('request', this._requestHandler);\n    }\n    else {\n        throw new Error('You must specify a WebSocketServer instance to attach to.');\n    }\n};\n\nWebSocketRouter.prototype.detachServer = function() {\n    if (this.server) {\n        this.server.removeListener('request', this._requestHandler);\n        this.server = null;\n    }\n    else {\n        throw new Error('Cannot detach from server: not attached.');\n    }\n};\n\nWebSocketRouter.prototype.mount = function(path, protocol, callback) {\n    if (!path) {\n        throw new Error('You must specify a path for this handler.');\n    }\n    if (!protocol) {\n        protocol = '____no_protocol____';\n    }\n    if (!callback) {\n        throw new Error('You must specify a callback for this handler.');\n    }\n\n    path = this.pathToRegExp(path);\n    if (!(path instanceof RegExp)) {\n        throw new Error('Path must be specified as either a string or a RegExp.');\n    }\n    var pathString = path.toString();\n\n    // normalize protocol to lower-case\n    protocol = protocol.toLocaleLowerCase();\n\n    if (this.findHandlerIndex(pathString, protocol) !== -1) {\n        throw new Error('You may only mount one handler per path/protocol combination.');\n    }\n\n    this.handlers.push({\n        'path': path,\n        'pathString': pathString,\n        'protocol': protocol,\n        'callback': callback\n    });\n};\nWebSocketRouter.prototype.unmount = function(path, protocol) {\n    var index = this.findHandlerIndex(this.pathToRegExp(path).toString(), protocol);\n    if (index !== -1) {\n        this.handlers.splice(index, 1);\n    }\n    else {\n        throw new Error('Unable to find a route matching the specified path and protocol.');\n    }\n};\n\nWebSocketRouter.prototype.findHandlerIndex = function(pathString, protocol) {\n    protocol = protocol.toLocaleLowerCase();\n    for (var i=0, len=this.handlers.length; i < len; i++) {\n        var handler = this.handlers[i];\n        if (handler.pathString === pathString && handler.protocol === protocol) {\n            return i;\n        }\n    }\n    return -1;\n};\n\nWebSocketRouter.prototype.pathToRegExp = function(path) {\n    if (typeof(path) === 'string') {\n        if (path === '*') {\n            path = /^.*$/;\n        }\n        else {\n            path = path.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&');\n            path = new RegExp('^' + path + '$');\n        }\n    }\n    return path;\n};\n\nWebSocketRouter.prototype.handleRequest = function(request) {\n    var requestedProtocols = request.requestedProtocols;\n    if (requestedProtocols.length === 0) {\n        requestedProtocols = ['____no_protocol____'];\n    }\n\n    // Find a handler with the first requested protocol first\n    for (var i=0; i < requestedProtocols.length; i++) {\n        var requestedProtocol = requestedProtocols[i].toLocaleLowerCase();\n\n        // find the first handler that can process this request\n        for (var j=0, len=this.handlers.length; j < len; j++) {\n            var handler = this.handlers[j];\n            if (handler.path.test(request.resourceURL.pathname)) {\n                if (requestedProtocol === handler.protocol ||\n                    handler.protocol === '*')\n                {\n                    var routerRequest = new WebSocketRouterRequest(request, requestedProtocol);\n                    handler.callback(routerRequest);\n                    return;\n                }\n            }\n        }\n    }\n\n    // If we get here we were unable to find a suitable handler.\n    request.reject(404, 'No handler is available for the given request.');\n};\n\nmodule.exports = WebSocketRouter;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}